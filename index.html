Here's the fully translated version of your HTML document to English:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Trainer</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .shape {
            position: absolute;
            opacity: 0.3;
            animation: float 15s infinite ease-in-out;
        }
        .circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
        }
        .triangle {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 100px solid rgba(255, 255, 255, 0.4);
        }
        .square {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.4);
        }
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        .container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10;
            position: relative;
            max-width: 600px;
            width: 90%;
            backdrop-filter: blur(5px);
        }
        h1 {
            color: #2c3e50;
            margin-top: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .problem {
            font-size: 28px;
            margin: 25px 0;
            padding: 20px;
            background-color: rgba(248, 249, 250, 0.7);
            border-radius: 10px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        input {
            font-size: 20px;
            padding: 10px;
            width: 120px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
            transition: all 0.3s;
        }
        input:focus {
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
            outline: none;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .result {
            font-size: 20px;
            margin: 20px 0;
            min-height: 30px;
            font-weight: bold;
        }
        .correct {
            color: #27ae60;
        }
        .incorrect {
            color: #e74c3c;
        }
        .stats {
            margin-top: 25px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .stat-box {
            background-color: rgba(236, 240, 241, 0.7);
            padding: 12px;
            border-radius: 8px;
            width: 28%;
            margin: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .operation-buttons {
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .operation-btn {
            background-color: #2ecc71;
            min-width: 100px;
        }
        .operation-btn.active {
            background-color: #2ecc71;
            font-weight: bold;
            transform: scale(1.05);
        }
        /* Modal window styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: black;
        }
        /* Tab styles */
        .theory-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab-btn {
            padding: 10px 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #555;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            color: #3498db;
            border-bottom: 3px solid #3498db;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .theory-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .theory-section h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .theory-section ul {
            padding-left: 20px;
        }
        .theory-section li {
            margin-bottom: 8px;
        }
        #theory-btn {
            background-color: #3498db;
        }
        #theory-btn:hover {
            background-color: #3498db;
        }
        #theorems-btn {
            background-color: #e67e22;
        }
        #theorems-btn:hover {
            background-color: #d35400;
        }
        .theorem-card {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .theorem-portrait {
            width: 120px;
            height: 160px;
            object-fit: cover;
        }
        .theorem-content {
            padding: 15px;
            flex: 1;
        }
        .theorem-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        .theorem-dates {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .theorem-text {
            font-size: 15px;
            line-height: 1.5;
        }
        @keyframes celebrate {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
.correct {
  color: #27ae60;
  animation: celebrate 0.5s ease;
}
/* Hover effect on scientist cards */
.theorem-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 15px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}
/* Timer styles */
.timer-container {
    display: flex;
    justify-content: center;
    margin: 15px 0;
}
.timer {
    font-size: 24px;
    font-weight: bold;
    color: #2c3e50;
    background-color: rgba(255, 255, 255, 0.7);
    padding: 8px 20px;
    border-radius: 30px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
}
/* Difficulty level styles */
.difficulty-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
}
.difficulty-btn {
    padding: 10px 15px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
}
.difficulty-btn.active {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
.difficulty-easy {
    background-color: #2ecc71;
}
.difficulty-medium {
    background-color: #f39c12;
}
.difficulty-hard {
    background-color: #e74c3c;
    color: white;
}
/* Stats styles */
#stats-btn {
    background-color: #9b59b6;
}
#stats-btn:hover {
    background-color: #8e44ad;
}
.stats-modal table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
}
.stats-modal th, .stats-modal td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}
.stats-modal th {
    background-color: #f2f2f2;
}
.stats-modal tr:hover {
    background-color: #f5f5f5;
}
.export-import {
    margin-top: 20px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
}
#export-stats, #import-stats, #clear-stats {
    padding: 10px 15px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
}
#export-stats {
    background-color: #2ecc71;
    color: white;
}
#import-stats {
    background-color: #3498db;
    color: white;
}
#clear-stats {
    background-color: #e74c3c;
    color: white;
}
#file-input {
    display: none;
}
/* Added styles */
#achievements-btn {
    background-color: #f1c40f;
    color: #2c3e50;
}
#achievements-btn:hover {
    background-color: #f39c12;
}
#progression-btn {
    background-color: #1abc9c;
    color: white;
}
#progression-btn:hover {
    background-color: #16a085;
}
.achievement-card {
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    background-color: #ecf0f1;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
}
.achievement-card.unlocked {
    background-color: #d5f5e3;
    border-left: 5px solid #27ae60;
}
.achievement-icon {
    font-size: 24px;
    margin-right: 15px;
    width: 40px;
    text-align: center;
}
.achievement-info {
    flex: 1;
}
.achievement-name {
    font-weight: bold;
    margin-bottom: 5px;
}
.achievement-desc {
    font-size: 14px;
    color: #7f8c8d;
}
.progression-stage {
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    background-color: #f8f9fa;
    border: 1px solid #ddd;
}
.progression-stage.completed {
    background-color: #e8f5e9;
    border-color: #4caf50;
}
.stage-title {
    font-weight: bold;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
}
.stage-icon {
    margin-right: 10px;
    font-size: 20px;
}
.stage-achievements {
    margin-top: 10px;
    padding-left: 20px;
}
.stage-achievement {
    margin: 5px 0;
    padding: 8px;
    background-color: #eee;
    border-radius: 4px;
    font-size: 14px;
}
.stage-achievement.unlocked {
    background-color: #c8e6c9;
    color: #2e7d32;
}
/* Consent window styles */
#consent-modal {
    display: flex;
    justify-content: center;
    align-items: center;
}
#consent-modal .modal-content {
    text-align: center;
    max-width: 500px;
}
.consent-buttons {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 20px;
}
.consent-btn {
    padding: 12px 25px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
}
#agree-btn {
    background-color: #27ae60;
    color: white;
}
#disagree-btn {
    background-color: #e74c3c;
    color: white;
}
.consent-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 8px rgba(0,0,0,0.15);
}
#agree-btn:hover {
    background-color: #219653;
}
#disagree-btn:hover {
    background-color: #c0392b;
}
.no-save-message {
    background-color: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
    color: #856404;
    text-align: center;
    font-weight: bold;
}
    </style>
</head>
<body>
    <!-- Floating geometric shapes -->
    <div class="shape circle" style="top:10%; left:5%; animation-delay:0s;"></div>
    <div class="shape triangle" style="top:70%; left:10%; animation-delay:2s;"></div>
    <div class="shape square" style="top:20%; left:80%; animation-delay:4s;"></div>
    <div class="shape circle" style="top:80%; left:85%; animation-delay:6s;"></div>
    <div class="shape triangle" style="top:30%; left:15%; animation-delay:8s;"></div>
    <div class="shape square" style="top:60%; left:75%; animation-delay:10s;"></div>
    
    <!-- Consent modal window -->
    <div id="consent-modal" class="modal" style="display: flex;">
        <div class="modal-content">
            <h2>Welcome to Math Trainer!</h2>
            <p>We want to notify you that all achievements, problem-solving statistics will be saved in your browser.</p>
            <p>This will allow you to track your progress and return to training without losing data.</p>
            <div class="consent-buttons">
                <button id="agree-btn" class="consent-btn">Yes, I agree</button>
                <button id="disagree-btn" class="consent-btn">No, thanks</button>
            </div>
        </div>
    </div>
    
    <div class="container" id="main-container" style="display: none;">
        <h1>Math Trainer</h1>
        <div id="no-save-warning" class="no-save-message" style="display: none;">
            Results will not be saved
        </div>
        <!-- Difficulty levels -->
        <div class="difficulty-buttons">
            <button class="difficulty-btn difficulty-easy active" data-difficulty="easy">Easy</button>
            <button class="difficulty-btn difficulty-medium" data-difficulty="medium">Medium</button>
            <button class="difficulty-btn difficulty-hard" data-difficulty="hard">Hard</button>
        </div>
        <!-- Timer -->
        <div class="timer-container">
            <div class="timer">Time: <span id="time">30</span> sec</div>
        </div>
        <div class="operation-buttons">
            <button class="operation-btn active" data-operation="+">Addition</button>
            <button class="operation-btn" data-operation="-">Subtraction</button>
            <button class="operation-btn" data-operation="*">Multiplication</button>
            <button class="operation-btn" data-operation="/">Division</button>
            <button id="theory-btn">Theory</button>
            <button id="theorems-btn">Theorems</button>
            <button id="stats-btn">Statistics</button>
            <button id="achievements-btn">Achievements</button>
            <button id="progression-btn">Progression</button>
        </div>
        <div class="problem" id="problem">2 + 3 = ?</div>
        <div>
            <input type="number" id="answer" placeholder="Answer">
            <div>
                <button id="check">Check</button>
                <button id="next">Next</button>
            </div>
        </div>
        <div class="result" id="result"></div>
        <div class="stats">
            <div class="stat-box">
                Correct: <span id="correct">0</span>
            </div>
            <div class="stat-box">
                Incorrect: <span id="incorrect">0</span>
            </div>
            <div class="stat-box">
                Total: <span id="total">0</span>
            </div>
        </div>
    </div>
    
    <!-- Theory modal window -->
    <div id="theory-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Math Theory</h2>
            <div class="theory-tabs">
                <button class="tab-btn active" data-tab="school">School (Grades 1-9)</button>
                <button class="tab-btn" data-tab="college">College</button>
                <button class="tab-btn" data-tab="university">University</button>
            </div>
            <div class="tab-content active" id="school-tab">
                <h3>Math Basics (Grades 1-9)</h3>
                <div class="theory-section">
                    <h4>Grades 1-4</h4>
                    <ul>
                        <li>Addition and subtraction</li>
                        <li>Multiplication and division</li>
                        <li>Fractions</li>
                        <li>Geometric shapes</li>
                    </ul>
                </div>
                <div class="theory-section">
                    <h4>Grades 5-9</h4>
                    <ul>
                        <li>Common and decimal fractions</li>
                        <li>Percentages</li>
                        <li>Algebraic expressions</li>
                        <li>Equations</li>
                        <li>Geometry: areas, volumes</li>
                    </ul>
                </div>
            </div>
            <div class="tab-content" id="college-tab">
                <h3>College Math</h3>
                <div class="theory-section">
                    <ul>
                        <li>Algebra basics</li>
                        <li>Trigonometry</li>
                        <li>Logarithms</li>
                        <li>Calculus basics</li>
                        <li>Applied mathematics</li>
                    </ul>
                </div>
            </div>
            <div class="tab-content" id="university-tab">
                <h3>Higher Mathematics</h3>
                <div class="theory-section">
                    <ul>
                        <li>Mathematical analysis</li>
                        <li>Linear algebra</li>
                        <li>Differential equations</li>
                        <li>Probability theory</li>
                        <li>Discrete mathematics</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Theorems modal window -->
    <div id="theorems-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('theorems-modal').style.display='none'">&times;</span>
            <h2>Great Theorems and Scientists</h2>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Pythagoras.jpg/220px-Pythagoras.jpg" alt="Pythagoras" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">Pythagoras of Samos</div>
                    <div class="theorem-dates">c. 570 - c. 495 BC</div>
                    <div class="theorem-text">
                        <strong>Pythagorean Theorem:</strong> In a right triangle, the square of the hypotenuse is equal to the sum of the squares of the legs.
                        cÂ² = aÂ² + bÂ². This theorem is fundamental to Euclidean geometry and has many applications.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Euclid.jpg/220px-Euclid.jpg" alt="Euclid" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">Euclid</div>
                    <div class="theorem-dates">c. 325 - c. 265 BC</div>
                    <div class="theorem-text">
                        <strong>Euclid's Axioms:</strong> Created a coherent system of geometry based on axioms. His work "Elements" became the foundation for teaching mathematics for over 2000 years.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Nikola_Tesla.jpg/220px-Nikola_Tesla.jpg" alt="Fermat" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">Pierre de Fermat</div>
                    <div class="theorem-dates">1601-1665</div>
                    <div class="theorem-text">
                        <strong>Fermat's Last Theorem:</strong> The equation xâ¿ + yâ¿ = zâ¿ has no solutions in natural numbers for n > 2. Proved by Andrew Wiles only in 1994.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Carl_Friedrich_Gauss.jpg/220px-Carl_Friedrich_Gauss.jpg" alt="Gauss" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">Carl Friedrich Gauss</div>
                    <div class="theorem-dates">1777-1855</div>
                    <div class="theorem-text">
                        <strong>Fundamental Theorem of Algebra:</strong> Every algebraic equation of degree n with complex coefficients has exactly n complex roots (counting multiplicities). Gauss gave the first rigorous proof of this theorem.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Statistics modal window -->
    <div id="stats-modal" class="modal stats-modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('stats-modal').style.display='none'">&times;</span>
            <h2>Progress Statistics</h2>
            <table id="stats-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Operation</th>
                        <th>Level</th>
                        <th>Result</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody id="stats-body">
                    <!-- Statistics will be inserted here -->
                </tbody>
            </table>
            <div class="export-import">
                <button id="export-stats">Export to JSON</button>
                <button id="import-stats">Import from JSON</button>
                <input type="file" id="file-input" accept=".json" style="display: none;">
                <button id="clear-stats">Clear Statistics</button>
            </div>
        </div>
    </div>
    
    <!-- Achievements modal window -->
    <div id="achievements-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('achievements-modal').style.display='none'">&times;</span>
            <h2>Achievements</h2>
            <div id="achievements-list">
                <!-- Achievements will be added here -->
            </div>
        </div>
    </div>

    <!-- Progression modal window -->
    <div id="progression-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('progression-modal').style.display='none'">&times;</span>
            <h2>Progression</h2>
            <div id="progression-stages">
                <!-- Progression stages will be added here -->
            </div>
        </div>
    </div>
    
    <script>
        // Flag to track user consent
        let userConsent = localStorage.getItem('mathTrainerConsent') === 'true';
        let saveData = userConsent; // Flag to determine whether to save data
        
        // Show or hide main window based on consent
        if (userConsent) {
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
        }
        
        // Handlers for consent buttons
        document.getElementById('agree-btn').addEventListener('click', function() {
            localStorage.setItem('mathTrainerConsent', 'true');
            userConsent = true;
            saveData = true;
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            initApp();
        });
        
        document.getElementById('disagree-btn').addEventListener('click', function() {
            localStorage.setItem('mathTrainerConsent', 'false');
            userConsent = false;
            saveData = false;
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('no-save-warning').style.display = 'block';
            initApp();
        });
        
        // Other variables and functions
        let currentOperation = '+';
        let currentDifficulty = 'easy';
        let num1, num2, correctAnswer;
        let correctCount = 0;
        let incorrectCount = 0;
        let totalCount = 0;
        let timeLeft = 30;
        let initialTime = 30;
        let timer;
        let stats = [];
        let achievements = {};
        
        // Initialize data from localStorage if user gave consent
        if (userConsent) {
            stats = JSON.parse(localStorage.getItem('mathTrainerStats')) || [];
            achievements = JSON.parse(localStorage.getItem('mathTrainerAchievements')) || {};
        }
        
        // Added variables and functions
        const achievementList = [
            {id: 'first_correct', name: 'First Success', desc: 'Solve the first problem correctly', icon: 'ðŸ¥‡'},
            {id: 'ten_correct', name: 'Perfect Ten', desc: 'Solve 10 problems correctly', icon: 'â­'},
            {id: 'fast_solver', name: 'Fast Solver', desc: 'Solve a problem in less than 5 seconds', icon: 'âš¡'},
            {id: 'perfect_score', name: 'No Mistakes', desc: 'Solve 5 problems in a row without errors', icon: 'ðŸŽ¯'},
            {id: 'master_addition', name: 'Addition Master', desc: 'Solve 20 addition problems correctly', icon: 'âž•'},
            {id: 'division_expert', name: 'Division Expert', desc: 'Solve 15 division problems correctly', icon: 'âž—'}
        ];

        const progressionStages = [
            {
                id: 'beginner',
                title: 'Beginner',
                description: 'Start your math journey',
                achievements: ['first_correct'],
                icon: 'ðŸŒ±'
            },
            {
                id: 'apprentice',
                title: 'Apprentice',
                description: 'Solve 10 problems correctly',
                achievements: ['ten_correct', 'fast_solver'],
                icon: 'ðŸ“š'
            },
            {
                id: 'adept',
                title: 'Adept',
                description: 'Master all basic operations',
                achievements: ['perfect_score', 'master_addition', 'division_expert'],
                icon: 'ðŸŽ“'
            }
        ];
        
        // DOM elements
        const problemElement = document.getElementById('problem');
        const answerElement = document.getElementById('answer');
        const resultElement = document.getElementById('result');
        const checkButton = document.getElementById('check');
        const nextButton = document.getElementById('next');
        const correctElement = document.getElementById('correct');
        const incorrectElement = document.getElementById('incorrect');
        const totalElement = document.getElementById('total');
        const timeElement = document.getElementById('time');
        const operationButtons = document.querySelectorAll('.operation-btn');
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        const theoryBtn = document.getElementById('theory-btn');
        const theoremsBtn = document.getElementById('theorems-btn');
        const statsBtn = document.getElementById('stats-btn');
        const exportStatsBtn = document.getElementById('export-stats');
        const importStatsBtn = document.getElementById('import-stats');
        const clearStatsBtn = document.getElementById('clear-stats');
        const fileInput = document.getElementById('file-input');
        const statsBody = document.getElementById('stats-body');
        
        // Added DOM elements
        const achievementsBtn = document.getElementById('achievements-btn');
        const progressionBtn = document.getElementById('progression-btn');
        
        // App initialization function
        function initApp() {
            // Generate new problem
            function generateProblem() {
                answerElement.value = '';
                resultElement.textContent = '';
                resultElement.className = 'result';
                clearInterval(timer);
                // Set time based on difficulty
                switch(currentDifficulty) {
                    case 'easy': 
                        timeLeft = 45;
                        initialTime = 45;
                        break;
                    case 'medium': 
                        timeLeft = 30;
                        initialTime = 30;
                        break;
                    case 'hard': 
                        timeLeft = 15;
                        initialTime = 15;
                        break;
                }
                timeElement.textContent = timeLeft;
                startTimer();
                // Generate numbers based on difficulty
                let maxNum, minNum;
                switch(currentDifficulty) {
                    case 'easy':
                        maxNum = 20;
                        minNum = 1;
                        break;
                    case 'medium':
                        maxNum = 50;
                        minNum = 10;
                        break;
                    case 'hard':
                        maxNum = 100;
                        minNum = 20;
                        break;
                }
                switch(currentOperation) {
                    case '+':
                        num1 = Math.floor(Math.random() * maxNum) + minNum;
                        num2 = Math.floor(Math.random() * maxNum) + minNum;
                        correctAnswer = num1 + num2;
                        break;
                    case '-':
                        num1 = Math.floor(Math.random() * maxNum) + minNum;
                        num2 = Math.floor(Math.random() * num1) + 1;
                        correctAnswer = num1 - num2;
                        break;
                    case '*':
                        num1 = Math.floor(Math.random() * (maxNum/5)) + minNum;
                        num2 = Math.floor(Math.random() * (maxNum/5)) + minNum;
                        correctAnswer = num1 * num2;
                        break;
                    case '/':
                        num2 = Math.floor(Math.random() * 10) + 1;
                        correctAnswer = Math.floor(Math.random() * 10) + 1;
                        num1 = num2 * correctAnswer;
                        break;
                }
                problemElement.textContent = `${num1} ${currentOperation} ${num2} = ?`;
                answerElement.focus();
            }
            
            // Timer
            function startTimer() {
                timer = setInterval(() => {
                    timeLeft--;
                    timeElement.textContent = timeLeft;
                    if(timeLeft <= 0) {
                        clearInterval(timer);
                        resultElement.textContent = 'â± Time is up!';
                        resultElement.className = 'result incorrect';
                        saveStat(currentOperation, currentDifficulty, false, initialTime);
                        incorrectCount++;
                        totalCount++;
                        updateStats();
                    }
                }, 1000);
            }
            
            // Check answer
            function checkAnswer() {
                clearInterval(timer);
                const timeSpent = initialTime - timeLeft;
                const userAnswer = parseInt(answerElement.value);
                if (isNaN(userAnswer)) {
                    resultElement.textContent = 'Enter a number!';
                    resultElement.className = 'result incorrect';
                    return;
                }
                
                const wasCorrect = (userAnswer === correctAnswer);
                
                if (wasCorrect) {
                    resultElement.textContent = 'âœ… Correct!';
                    resultElement.className = 'result correct';
                    correctCount++;
                    saveStat(currentOperation, currentDifficulty, true, timeSpent);
                    
                    // Check specific achievements
                    if (timeSpent < 5 && !achievements['fast_solver']) {
                        unlockAchievement('fast_solver');
                    }
                } else {
                    resultElement.textContent = `âŒ Incorrect! Correct answer: ${correctAnswer}`;
                    resultElement.className = 'result incorrect';
                    incorrectCount++;
                    saveStat(currentOperation, currentDifficulty, false, timeSpent);
                }
                
                totalCount++;
                updateStats();
                checkAchievements(); // Check achievements after each answer
            }
            
            // Save statistics
            function saveStat(operation, difficulty, isCorrect, timeSpent) {
                if (!saveData) return; // Don't save if user didn't give consent
                
                const operationNames = {
                    '+': 'Addition',
                    '-': 'Subtraction',
                    '*': 'Multiplication',
                    '/': 'Division'
                };
                const difficultyNames = {
                    'easy': 'Easy',
                    'medium': 'Medium',
                    'hard': 'Hard'
                };
                const statEntry = {
                    date: new Date().toLocaleString(),
                    operation: operationNames[operation],
                    difficulty: difficultyNames[difficulty],
                    result: isCorrect ? 'Correct' :
