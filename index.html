<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .shape {
            position: absolute;
            opacity: 0.3;
            animation: float 15s infinite ease-in-out;
        }
        .circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
        }
        .triangle {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 100px solid rgba(255, 255, 255, 0.4);
        }
        .square {
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.4);
        }
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }
        .container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 10;
            position: relative;
            max-width: 600px;
            width: 90%;
            backdrop-filter: blur(5px);
        }
        h1 {
            color: #2c3e50;
            margin-top: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .problem {
            font-size: 28px;
            margin: 25px 0;
            padding: 20px;
            background-color: rgba(248, 249, 250, 0.7);
            border-radius: 10px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        input {
            font-size: 20px;
            padding: 10px;
            width: 120px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
            transition: all 0.3s;
        }
        input:focus {
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.5);
            outline: none;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .result {
            font-size: 20px;
            margin: 20px 0;
            min-height: 30px;
            font-weight: bold;
        }
        .correct {
            color: #27ae60;
        }
        .incorrect {
            color: #e74c3c;
        }
        .stats {
            margin-top: 25px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .stat-box {
            background-color: rgba(236, 240, 241, 0.7);
            padding: 12px;
            border-radius: 8px;
            width: 28%;
            margin: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .operation-buttons {
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .operation-btn {
            background-color: #2ecc71;
            min-width: 100px;
        }
        .operation-btn.active {
            background-color: #2ecc71;
            font-weight: bold;
            transform: scale(1.05);
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: black;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .theory-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab-btn {
            padding: 10px 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            color: #555;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            color: #3498db;
            border-bottom: 3px solid #3498db;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .theory-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .theory-section h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .theory-section ul {
            padding-left: 20px;
        }
        .theory-section li {
            margin-bottom: 8px;
        }
        #theory-btn {
            background-color: #3498db;
        }
        #theory-btn:hover {
            background-color: #3498db;
        }
        #theorems-btn {
            background-color: #e67e22;
        }
        #theorems-btn:hover {
            background-color: #d35400;
        }
        .theorem-card {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .theorem-portrait {
            width: 120px;
            height: 160px;
            object-fit: cover;
        }
        .theorem-content {
            padding: 15px;
            flex: 1;
        }
        .theorem-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        .theorem-dates {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .theorem-text {
            font-size: 15px;
            line-height: 1.5;
        }
        @keyframes celebrate {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
.correct {
  color: #27ae60;
  animation: celebrate 0.5s ease;
}
/* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ —É—á–µ–Ω—ã—Ö */
.theorem-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 15px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ */
.timer-container {
    display: flex;
    justify-content: center;
    margin: 15px 0;
}
.timer {
    font-size: 24px;
    font-weight: bold;
    color: #2c3e50;
    background-color: rgba(255, 255, 255, 0.7);
    padding: 8px 20px;
    border-radius: 30px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
}
/* –°—Ç–∏–ª–∏ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ */
.difficulty-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
}
.difficulty-btn {
    padding: 10px 15px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
}
.difficulty-btn.active {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}
.difficulty-easy {
    background-color: #2ecc71;
}
.difficulty-medium {
    background-color: #f39c12;
}
.difficulty-hard {
    background-color: #e74c3c;
    color: white;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
#stats-btn {
    background-color: #9b59b6;
}
#stats-btn:hover {
    background-color: #8e44ad;
}
.stats-modal table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
}
.stats-modal th, .stats-modal td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}
.stats-modal th {
    background-color: #f2f2f2;
}
.stats-modal tr:hover {
    background-color: #f5f5f5;
}
.export-import {
    margin-top: 20px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
}
#export-stats, #import-stats, #clear-stats {
    padding: 10px 15px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    transition: all 0.3s;
}
#export-stats {
    background-color: #2ecc71;
    color: white;
}
#import-stats {
    background-color: #3498db;
    color: white;
}
#clear-stats {
    background-color: #e74c3c;
    color: white;
}
#file-input {
    display: none;
}
/* –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ */
#achievements-btn {
    background-color: #f1c40f;
    color: #2c3e50;
}
#achievements-btn:hover {
    background-color: #f39c12;
}
#progression-btn {
    background-color: #1abc9c;
    color: white;
}
#progression-btn:hover {
    background-color: #16a085;
}
.achievement-card {
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    background-color: #ecf0f1;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
}
.achievement-card.unlocked {
    background-color: #d5f5e3;
    border-left: 5px solid #27ae60;
}
.achievement-icon {
    font-size: 24px;
    margin-right: 15px;
    width: 40px;
    text-align: center;
}
.achievement-info {
    flex: 1;
}
.achievement-name {
    font-weight: bold;
    margin-bottom: 5px;
}
.achievement-desc {
    font-size: 14px;
    color: #7f8c8d;
}
.progression-stage {
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    background-color: #f8f9fa;
    border: 1px solid #ddd;
}
.progression-stage.completed {
    background-color: #e8f5e9;
    border-color: #4caf50;
}
.stage-title {
    font-weight: bold;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
}
.stage-icon {
    margin-right: 10px;
    font-size: 20px;
}
.stage-achievements {
    margin-top: 10px;
    padding-left: 20px;
}
.stage-achievement {
    margin: 5px 0;
    padding: 8px;
    background-color: #eee;
    border-radius: 4px;
    font-size: 14px;
}
.stage-achievement.unlocked {
    background-color: #c8e6c9;
    color: #2e7d32;
}
/* –°—Ç–∏–ª–∏ –¥–ª—è –æ–∫–Ω–∞ —Å–æ–≥–ª–∞—Å–∏—è */
#consent-modal {
    display: flex;
    justify-content: center;
    align-items: center;
}
#consent-modal .modal-content {
    text-align: center;
    max-width: 500px;
}
.consent-buttons {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 20px;
}
.consent-btn {
    padding: 12px 25px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
}
#agree-btn {
    background-color: #27ae60;
    color: white;
}
#disagree-btn {
    background-color: #e74c3c;
    color: white;
}
.consent-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 8px rgba(0,0,0,0.15);
}
#agree-btn:hover {
    background-color: #219653;
}
#disagree-btn:hover {
    background-color: #c0392b;
}
.no-save-message {
    background-color: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
    color: #856404;
    text-align: center;
    font-weight: bold;
}
    </style>
</head>
<body>
    <!-- –ü–ª–∞–≤–∞—é—â–∏–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∏–≥—É—Ä—ã -->
    <div class="shape circle" style="top:10%; left:5%; animation-delay:0s;"></div>
    <div class="shape triangle" style="top:70%; left:10%; animation-delay:2s;"></div>
    <div class="shape square" style="top:20%; left:80%; animation-delay:4s;"></div>
    <div class="shape circle" style="top:80%; left:85%; animation-delay:6s;"></div>
    <div class="shape triangle" style="top:30%; left:15%; animation-delay:8s;"></div>
    <div class="shape square" style="top:60%; left:75%; animation-delay:10s;"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–≥–ª–∞—Å–∏—è -->
    <div id="consent-modal" class="modal" style="display: flex;">
        <div class="modal-content">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä!</h2>
            <p>–ú—ã —Ö–æ—Ç–∏–º —É–≤–µ–¥–æ–º–∏—Ç—å –≤–∞—Å, —á—Ç–æ –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏–º–µ—Ä–æ–≤ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.</p>
            <p>–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö.</p>
            <div class="consent-buttons">
                <button id="agree-btn" class="consent-btn">–î–∞, —è —Å–æ–≥–ª–∞—Å–µ–Ω</button>
                <button id="disagree-btn" class="consent-btn">–ù–µ—Ç, —Å–ø–∞—Å–∏–±–æ</button>
            </div>
        </div>
    </div>
    
    <div class="container" id="main-container" style="display: none;">
        <h1>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä</h1>
        <div id="no-save-warning" class="no-save-message" style="display: none;">
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è
        </div>
        <!-- –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ -->
        <div class="difficulty-buttons">
            <button class="difficulty-btn difficulty-easy active" data-difficulty="easy">–õ–µ–≥–∫–∏–π</button>
            <button class="difficulty-btn difficulty-medium" data-difficulty="medium">–°—Ä–µ–¥–Ω–∏–π</button>
            <button class="difficulty-btn difficulty-hard" data-difficulty="hard">–°–ª–æ–∂–Ω—ã–π</button>
        </div>
        <!-- –¢–∞–π–º–µ—Ä -->
        <div class="timer-container">
            <div class="timer">–í—Ä–µ–º—è: <span id="time">30</span> —Å–µ–∫</div>
        </div>
        <div class="operation-buttons">
            <button class="operation-btn active" data-operation="+">–°–ª–æ–∂–µ–Ω–∏–µ</button>
            <button class="operation-btn" data-operation="-">–í—ã—á–∏—Ç–∞–Ω–∏–µ</button>
            <button class="operation-btn" data-operation="*">–£–º–Ω–æ–∂–µ–Ω–∏–µ</button>
            <button class="operation-btn" data-operation="/">–î–µ–ª–µ–Ω–∏–µ</button>
            <button id="theory-btn">–¢–µ–æ—Ä–∏—è</button>
            <button id="theorems-btn">–¢–µ–æ—Ä–µ–º—ã</button>
            <button id="stats-btn">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button id="achievements-btn">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
            <button id="progression-btn">–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ</button>
        </div>
        <div class="problem" id="problem">2 + 3 = ?</div>
        <div>
            <input type="number" id="answer" placeholder="–û—Ç–≤–µ—Ç">
            <div>
                <button id="check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <button id="next">–°–ª–µ–¥—É—é—â–∏–π</button>
            </div>
        </div>
        <div class="result" id="result"></div>
        <div class="stats">
            <div class="stat-box">
                –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="correct">0</span>
            </div>
            <div class="stat-box">
                –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="incorrect">0</span>
            </div>
            <div class="stat-box">
                –í—Å–µ–≥–æ: <span id="total">0</span>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–µ–æ—Ä–∏–∏ -->
    <div id="theory-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–¢–µ–æ—Ä–∏—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏</h2>
            <div class="theory-tabs">
                <button class="tab-btn active" data-tab="school">–®–∫–æ–ª–∞ (1-9 –∫–ª–∞—Å—Å)</button>
                <button class="tab-btn" data-tab="college">–ö–æ–ª–ª–µ–¥–∂</button>
                <button class="tab-btn" data-tab="university">–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç</button>
            </div>
            <div class="tab-content active" id="school-tab">
                <h3>–û—Å–Ω–æ–≤—ã –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ (1-9 –∫–ª–∞—Å—Å)</h3>
                <div class="theory-section">
                    <h4>1-4 –∫–ª–∞—Å—Å</h4>
                    <ul>
                        <li>–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ</li>
                        <li>–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ</li>
                        <li>–î—Ä–æ–±–∏</li>
                        <li>–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ñ–∏–≥—É—Ä—ã</li>
                    </ul>
                </div>
                <div class="theory-section">
                    <h4>5-9 –∫–ª–∞—Å—Å</h4>
                    <ul>
                        <li>–û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –∏ –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏</li>
                        <li>–ü—Ä–æ—Ü–µ–Ω—Ç—ã</li>
                        <li>–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è</li>
                        <li>–£—Ä–∞–≤–Ω–µ–Ω–∏—è</li>
                        <li>–ì–µ–æ–º–µ—Ç—Ä–∏—è: –ø–ª–æ—â–∞–¥–∏, –æ–±—ä–µ–º—ã</li>
                    </ul>
                </div>
            </div>
            <div class="tab-content" id="college-tab">
                <h3>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è –∫–æ–ª–ª–µ–¥–∂–∞</h3>
                <div class="theory-section">
                    <ul>
                        <li>–û—Å–Ω–æ–≤—ã –∞–ª–≥–µ–±—Ä—ã</li>
                        <li>–¢—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—è</li>
                        <li>–õ–æ–≥–∞—Ä–∏—Ñ–º—ã</li>
                        <li>–û—Å–Ω–æ–≤—ã –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</li>
                        <li>–ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞</li>
                    </ul>
                </div>
            </div>
            <div class="tab-content" id="university-tab">
                <h3>–í—ã—Å—à–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞</h3>
                <div class="theory-section">
                    <ul>
                        <li>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</li>
                        <li>–õ–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞</li>
                        <li>–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è</li>
                        <li>–¢–µ–æ—Ä–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
                        <li>–î–∏—Å–∫—Ä–µ—Ç–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–µ–æ—Ä–µ–º -->
    <div id="theorems-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('theorems-modal').style.display='none'">&times;</span>
            <h2>–í–µ–ª–∏–∫–∏–µ —Ç–µ–æ—Ä–µ–º—ã –∏ —É—á–µ–Ω—ã–µ</h2>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Pythagoras.jpg/220px-Pythagoras.jpg" alt="–ü–∏—Ñ–∞–≥–æ—Ä" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">–ü–∏—Ñ–∞–≥–æ—Ä –°–∞–º–æ—Å—Å–∫–∏–π</div>
                    <div class="theorem-dates">–æ–∫. 570 - –æ–∫. 495 –¥–æ –Ω.—ç.</div>
                    <div class="theorem-text">
                        <strong>–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞:</strong> –í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–≤–∞–¥—Ä–∞—Ç –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∫–∞—Ç–µ—Ç–æ–≤.
                        c¬≤ = a¬≤ + b¬≤. –≠—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ –µ–≤–∫–ª–∏–¥–æ–≤–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –∏ –∏–º–µ–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Euclid.jpg/220px-Euclid.jpg" alt="–ï–≤–∫–ª–∏–¥" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">–ï–≤–∫–ª–∏–¥</div>
                    <div class="theorem-dates">–æ–∫. 325 - –æ–∫. 265 –¥–æ –Ω.—ç.</div>
                    <div class="theorem-text">
                        <strong>–ê–∫—Å–∏–æ–º–∞—Ç–∏–∫–∞ –ï–≤–∫–ª–∏–¥–∞:</strong> –°–æ–∑–¥–∞–ª —Å—Ç—Ä–æ–π–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≥–µ–æ–º–µ—Ç—Ä–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—É—é –Ω–∞ –∞–∫—Å–∏–æ–º–∞—Ö. –ï–≥–æ —Ç—Ä—É–¥ "–ù–∞—á–∞–ª–∞" —Å—Ç–∞–ª –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –±–æ–ª–µ–µ 2000 –ª–µ—Ç.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Nikola_Tesla.jpg/220px-Nikola_Tesla.jpg" alt="–§–µ—Ä–º–∞" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">–ü—å–µ—Ä –¥–µ –§–µ—Ä–º–∞</div>
                    <div class="theorem-dates">1601-1665</div>
                    <div class="theorem-text">
                        <strong>–í–µ–ª–∏–∫–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞:</strong> –£—Ä–∞–≤–Ω–µ–Ω–∏–µ x‚Åø + y‚Åø = z‚Åø –Ω–µ –∏–º–µ–µ—Ç —Ä–µ—à–µ–Ω–∏–π –≤ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–ª–∞—Ö –ø—Ä–∏ n > 2. –î–æ–∫–∞–∑–∞–Ω–∞ –≠–Ω–¥—Ä—é –£–∞–π–ª—Å–æ–º —Ç–æ–ª—å–∫–æ –≤ 1994 –≥–æ–¥—É.
                    </div>
                </div>
            </div>
            <div class="theorem-card">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Carl_Friedrich_Gauss.jpg/220px-Carl_Friedrich_Gauss.jpg" alt="–ì–∞—É—Å—Å" class="theorem-portrait">
                <div class="theorem-content">
                    <div class="theorem-name">–ö–∞—Ä–ª –§—Ä–∏–¥—Ä–∏—Ö –ì–∞—É—Å—Å</div>
                    <div class="theorem-dates">1777-1855</div>
                    <div class="theorem-text">
                        <strong>–û—Å–Ω–æ–≤–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –∞–ª–≥–µ–±—Ä—ã:</strong> –õ—é–±–æ–µ –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ n —Å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –∏–º–µ–µ—Ç —Ä–æ–≤–Ω–æ n –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π (—Å —É—á–µ—Ç–æ–º –∫—Ä–∞—Ç–Ω–æ—Å—Ç–∏). –ì–∞—É—Å—Å –¥–∞–ª –ø–µ—Ä–≤–æ–µ —Å—Ç—Ä–æ–≥–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —ç—Ç–æ–π —Ç–µ–æ—Ä–µ–º—ã.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="stats-modal" class="modal stats-modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('stats-modal').style.display='none'">&times;</span>
            <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è</h2>
            <table id="stats-table">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–û–ø–µ—Ä–∞—Ü–∏—è</th>
                        <th>–£—Ä–æ–≤–µ–Ω—å</th>
                        <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                        <th>–í—Ä–µ–º—è</th>
                    </tr>
                </thead>
                <tbody id="stats-body">
                    <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                </tbody>
            </table>
            <div class="export-import">
                <button id="export-stats">–≠–∫—Å–ø–æ—Ä—Ç –≤ JSON</button>
                <button id="import-stats">–ò–º–ø–æ—Ä—Ç –∏–∑ JSON</button>
                <input type="file" id="file-input" accept=".json" style="display: none;">
                <button id="clear-stats">–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
    <div id="achievements-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('achievements-modal').style.display='none'">&times;</span>
            <h2>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            <div id="achievements-list">
                <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è -->
    <div id="progression-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('progression-modal').style.display='none'">&times;</span>
            <h2>–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ</h2>
            <div id="progression-stages">
                <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —ç—Ç–∞–ø—ã –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è -->
            </div>
        </div>
    </div>
    
    <script>
        // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userConsent = localStorage.getItem('mathTrainerConsent') === 'true';
        let saveData = userConsent; // –§–ª–∞–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –Ω—É–∂–Ω–æ –ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–ª–∏ —Å–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–≥–ª–∞—Å–∏—è
        if (userConsent) {
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Å–æ–≥–ª–∞—Å–∏—è
        document.getElementById('agree-btn').addEventListener('click', function() {
            localStorage.setItem('mathTrainerConsent', 'true');
            userConsent = true;
            saveData = true;
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            initApp();
        });
        
        document.getElementById('disagree-btn').addEventListener('click', function() {
            localStorage.setItem('mathTrainerConsent', 'false');
            userConsent = false;
            saveData = false;
            document.getElementById('consent-modal').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('no-save-warning').style.display = 'block';
            initApp();
        });
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
        let currentOperation = '+';
        let currentDifficulty = 'easy';
        let num1, num2, correctAnswer;
        let correctCount = 0;
        let incorrectCount = 0;
        let totalCount = 0;
        let timeLeft = 30;
        let initialTime = 30;
        let timer;
        let stats = [];
        let achievements = {};
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–ª —Å–æ–≥–ª–∞—Å–∏–µ
        if (userConsent) {
            stats = JSON.parse(localStorage.getItem('mathTrainerStats')) || [];
            achievements = JSON.parse(localStorage.getItem('mathTrainerAchievements')) || {};
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
        const achievementList = [
            {id: 'first_correct', name: '–ü–µ—Ä–≤—ã–π —É—Å–ø–µ—Ö', desc: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É', icon: 'ü•á'},
            {id: 'ten_correct', name: '–î–µ—Å—è—Ç–æ—á–∫–∞', desc: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç–µ 10 –∑–∞–¥–∞—á', icon: '‚≠ê'},
            {id: 'fast_solver', name: '–ë—ã—Å—Ç—Ä—ã–π —Ä–µ—à–∞—Ç–µ–ª—å', desc: '–†–µ—à–∏—Ç–µ –∑–∞–¥–∞—á—É –º–µ–Ω–µ–µ —á–µ–º –∑–∞ 5 —Å–µ–∫—É–Ω–¥', icon: '‚ö°'},
            {id: 'perfect_score', name: '–ë–µ–∑ –æ—à–∏–±–æ–∫', desc: '–†–µ—à–∏—Ç–µ 5 –∑–∞–¥–∞—á –ø–æ–¥—Ä—è–¥ –±–µ–∑ –æ—à–∏–±–æ–∫', icon: 'üéØ'},
            {id: 'master_addition', name: '–ú–∞—Å—Ç–µ—Ä —Å–ª–æ–∂–µ–Ω–∏—è', desc: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç–µ 20 –∑–∞–¥–∞—á –Ω–∞ —Å–ª–æ–∂–µ–Ω–∏–µ', icon: '‚ûï'},
            {id: 'division_expert', name: '–≠–∫—Å–ø–µ—Ä—Ç –ø–æ –¥–µ–ª–µ–Ω–∏—é', desc: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç–µ 15 –∑–∞–¥–∞—á –Ω–∞ –¥–µ–ª–µ–Ω–∏–µ', icon: '‚ûó'}
        ];

        const progressionStages = [
            {
                id: 'beginner',
                title: '–ù–æ–≤–∏—á–æ–∫',
                description: '–ù–∞—á–Ω–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å –≤ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ',
                achievements: ['first_correct'],
                icon: 'üå±'
            },
            {
                id: 'apprentice',
                title: '–£—á–µ–Ω–∏–∫',
                description: '–†–µ—à–∏—Ç–µ 10 –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ',
                achievements: ['ten_correct', 'fast_solver'],
                icon: 'üìö'
            },
            {
                id: 'adept',
                title: '–ó–Ω–∞—Ç–æ–∫',
                description: '–û—Å–≤–æ–π—Ç–µ –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏',
                achievements: ['perfect_score', 'master_addition', 'division_expert'],
                icon: 'üéì'
            }
        ];
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const problemElement = document.getElementById('problem');
        const answerElement = document.getElementById('answer');
        const resultElement = document.getElementById('result');
        const checkButton = document.getElementById('check');
        const nextButton = document.getElementById('next');
        const correctElement = document.getElementById('correct');
        const incorrectElement = document.getElementById('incorrect');
        const totalElement = document.getElementById('total');
        const timeElement = document.getElementById('time');
        const operationButtons = document.querySelectorAll('.operation-btn');
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        const theoryBtn = document.getElementById('theory-btn');
        const theoremsBtn = document.getElementById('theorems-btn');
        const statsBtn = document.getElementById('stats-btn');
        const exportStatsBtn = document.getElementById('export-stats');
        const importStatsBtn = document.getElementById('import-stats');
        const clearStatsBtn = document.getElementById('clear-stats');
        const fileInput = document.getElementById('file-input');
        const statsBody = document.getElementById('stats-body');
        
        // –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const achievementsBtn = document.getElementById('achievements-btn');
        const progressionBtn = document.getElementById('progression-btn');
        
        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
            function generateProblem() {
                answerElement.value = '';
                resultElement.textContent = '';
                resultElement.className = 'result';
                clearInterval(timer);
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                switch(currentDifficulty) {
                    case 'easy': 
                        timeLeft = 45;
                        initialTime = 45;
                        break;
                    case 'medium': 
                        timeLeft = 30;
                        initialTime = 30;
                        break;
                    case 'hard': 
                        timeLeft = 15;
                        initialTime = 15;
                        break;
                }
                timeElement.textContent = timeLeft;
                startTimer();
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–∏—Å–µ–ª –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                let maxNum, minNum;
                switch(currentDifficulty) {
                    case 'easy':
                        maxNum = 20;
                        minNum = 1;
                        break;
                    case 'medium':
                        maxNum = 50;
                        minNum = 10;
                        break;
                    case 'hard':
                        maxNum = 100;
                        minNum = 20;
                        break;
                }
                switch(currentOperation) {
                    case '+':
                        num1 = Math.floor(Math.random() * maxNum) + minNum;
                        num2 = Math.floor(Math.random() * maxNum) + minNum;
                        correctAnswer = num1 + num2;
                        break;
                    case '-':
                        num1 = Math.floor(Math.random() * maxNum) + minNum;
                        num2 = Math.floor(Math.random() * num1) + 1;
                        correctAnswer = num1 - num2;
                        break;
                    case '*':
                        num1 = Math.floor(Math.random() * (maxNum/5)) + minNum;
                        num2 = Math.floor(Math.random() * (maxNum/5)) + minNum;
                        correctAnswer = num1 * num2;
                        break;
                    case '/':
                        num2 = Math.floor(Math.random() * 10) + 1;
                        correctAnswer = Math.floor(Math.random() * 10) + 1;
                        num1 = num2 * correctAnswer;
                        break;
                }
                problemElement.textContent = `${num1} ${currentOperation} ${num2} = ?`;
                answerElement.focus();
            }
            
            // –¢–∞–π–º–µ—Ä
            function startTimer() {
                timer = setInterval(() => {
                    timeLeft--;
                    timeElement.textContent = timeLeft;
                    if(timeLeft <= 0) {
                        clearInterval(timer);
                        resultElement.textContent = '‚è± –í—Ä–µ–º—è –≤—ã—à–ª–æ!';
                        resultElement.className = 'result incorrect';
                        saveStat(currentOperation, currentDifficulty, false, initialTime);
                        incorrectCount++;
                        totalCount++;
                        updateStats();
                    }
                }, 1000);
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
            function checkAnswer() {
                clearInterval(timer);
                const timeSpent = initialTime - timeLeft;
                const userAnswer = parseInt(answerElement.value);
                if (isNaN(userAnswer)) {
                    resultElement.textContent = '–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!';
                    resultElement.className = 'result incorrect';
                    return;
                }
                
                const wasCorrect = (userAnswer === correctAnswer);
                
                if (wasCorrect) {
                    resultElement.textContent = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                    resultElement.className = 'result correct';
                    correctCount++;
                    saveStat(currentOperation, currentDifficulty, true, timeSpent);
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                    if (timeSpent < 5 && !achievements['fast_solver']) {
                        unlockAchievement('fast_solver');
                    }
                } else {
                    resultElement.textContent = `‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}`;
                    resultElement.className = 'result incorrect';
                    incorrectCount++;
                    saveStat(currentOperation, currentDifficulty, false, timeSpent);
                }
                
                totalCount++;
                updateStats();
                checkAchievements(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function saveStat(operation, difficulty, isCorrect, timeSpent) {
                if (!saveData) return; // –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–∞–ª —Å–æ–≥–ª–∞—Å–∏–µ
                
                const operationNames = {
                    '+': '–°–ª–æ–∂–µ–Ω–∏–µ',
                    '-': '–í—ã—á–∏—Ç–∞–Ω–∏–µ',
                    '*': '–£–º–Ω–æ–∂–µ–Ω–∏–µ',
                    '/': '–î–µ–ª–µ–Ω–∏–µ'
                };
                const difficultyNames = {
                    'easy': '–õ–µ–≥–∫–∏–π',
                    'medium': '–°—Ä–µ–¥–Ω–∏–π',
                    'hard': '–°–ª–æ–∂–Ω—ã–π'
                };
                const statEntry = {
                    date: new Date().toLocaleString(),
                    operation: operationNames[operation],
                    difficulty: difficultyNames[difficulty],
                    result: isCorrect ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ' : '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ',
                    time: timeSpent + ' —Å–µ–∫'
                };
                stats.push(statEntry);
                if (userConsent) {
                    localStorage.setItem('mathTrainerStats', JSON.stringify(stats));
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            function showStats() {
                statsBody.innerHTML = '';
                stats.forEach(stat => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${stat.date}</td>
                        <td>${stat.operation}</td>
                        <td>${stat.difficulty}</td>
                        <td>${stat.result}</td>
                        <td>${stat.time}</td>
                    `;
                    statsBody.appendChild(row);
                });
                document.getElementById('stats-modal').style.display = 'block';
            }
            
            // –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function exportStats() {
                if (!saveData) {
                    alert('–≠–∫—Å–ø–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –≤—ã –Ω–µ –¥–∞–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.');
                    return;
                }
                const dataStr = JSON.stringify(stats, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = 'math-trainer-stats.json';
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            }
            
            // –ò–º–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function importStats() {
                if (!saveData) {
                    alert('–ò–º–ø–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ç–∞–∫ –∫–∞–∫ –≤—ã –Ω–µ –¥–∞–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.');
                    return;
                }
                fileInput.click();
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function clearStats() {
                if (!saveData) {
                    alert('–û—á–∏—Å—Ç–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –≤—ã –Ω–µ –¥–∞–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.');
                    return;
                }
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                    stats = [];
                    if (userConsent) {
                        localStorage.removeItem('mathTrainerStats');
                    }
                    showStats();
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            function updateStats() {
                correctElement.textContent = correctCount;
                incorrectElement.textContent = incorrectCount;
                totalElement.textContent = totalCount;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            function checkAchievements() {
                if (!saveData) return; // –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                if (!achievements['first_correct'] && correctCount >= 1) {
                    unlockAchievement('first_correct');
                }
                if (!achievements['ten_correct'] && correctCount >= 10) {
                    unlockAchievement('ten_correct');
                }
                if (!achievements['master_addition'] && getOperationStats('+') >= 20) {
                    unlockAchievement('master_addition');
                }
                if (!achievements['division_expert'] && getOperationStats('/') >= 15) {
                    unlockAchievement('division_expert');
                }
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–∏—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
                if (!achievements['perfect_score']) {
                    // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø—Ä–∏–º–µ—Ä–∞, –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ª—É—á—à–µ —Ö—Ä–∞–Ω–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
                }
            }

            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–∏
            function getOperationStats(operation) {
                return stats.filter(s => 
                    s.operation === getOperationName(operation) && 
                    s.result === '–ü—Ä–∞–≤–∏–ª—å–Ω–æ'
                ).length;
            }

            function getOperationName(op) {
                const names = {
                    '+': '–°–ª–æ–∂–µ–Ω–∏–µ',
                    '-': '–í—ã—á–∏—Ç–∞–Ω–∏–µ',
                    '*': '–£–º–Ω–æ–∂–µ–Ω–∏–µ',
                    '/': '–î–µ–ª–µ–Ω–∏–µ'
                };
                return names[op] || op;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            function unlockAchievement(id) {
                if (!saveData) return; // –ù–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
                
                if (!achievements[id]) {
                    achievements[id] = new Date().toLocaleString();
                    if (userConsent) {
                        localStorage.setItem('mathTrainerAchievements', JSON.stringify(achievements));
                    }
                    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏
                    console.log(`–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: ${id}`);
                }
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            function showAchievements() {
                if (!saveData) {
                    alert('–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, —Ç–∞–∫ –∫–∞–∫ –≤—ã –Ω–µ –¥–∞–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.');
                    return;
                }
                const list = document.getElementById('achievements-list');
                list.innerHTML = '';
                
                achievementList.forEach(ach => {
                    const isUnlocked = achievements[ach.id];
                    const card = document.createElement('div');
                    card.className = `achievement-card ${isUnlocked ? 'unlocked' : ''}`;
                    card.innerHTML = `
                        <div class="achievement-icon">${ach.icon}</div>
                        <div class="achievement-info">
                            <div class="achievement-name">${ach.name}</div>
                            <div class="achievement-desc">${ach.desc}</div>
                            ${isUnlocked ? `<div class="achievement-date">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: ${achievements[ach.id]}</div>` : ''}
                        </div>
                    `;
                    list.appendChild(card);
                });
                
                document.getElementById('achievements-modal').style.display = 'block';
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
            function showProgression() {
                if (!saveData) {
                    alert('–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –≤—ã –Ω–µ –¥–∞–ª–∏ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.');
                    return;
                }
                const stagesContainer = document.getElementById('progression-stages');
                stagesContainer.innerHTML = '';
                
                progressionStages.forEach(stage => {
                    const isCompleted = stage.achievements.every(id => achievements[id]);
                    const stageElement = document.createElement('div');
                    stageElement.className = `progression-stage ${isCompleted ? 'completed' : ''}`;
                    
                    let achievementsHtml = '';
                    stage.achievements.forEach(achId => {
                        const ach = achievementList.find(a => a.id === achId);
                        const isUnlocked = achievements[achId];
                        achievementsHtml += `
                            <div class="stage-achievement ${isUnlocked ? 'unlocked' : ''}">
                                ${ach.icon} ${ach.name}
                            </div>
                        `;
                    });
                    
                    stageElement.innerHTML = `
                        <div class="stage-title">
                            <span class="stage-icon">${stage.icon}</span>
                            <span>${stage.title}</span>
                            ${isCompleted ? '<span style="margin-left: auto; color: #4caf50;">‚úì –ó–∞–≤–µ—Ä—à–µ–Ω–æ</span>' : ''}
                        </div>
                        <div>${stage.description}</div>
                        <div class="stage-achievements">
                            <strong>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —ç—Ç–∞–ø–∞:</strong>
                            ${achievementsHtml}
                        </div>
                    `;
                    
                    stagesContainer.appendChild(stageElement);
                });
                
                document.getElementById('progression-modal').style.display = 'block';
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            checkButton.addEventListener('click', checkAnswer);
            nextButton.addEventListener('click', generateProblem);
            answerElement.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            operationButtons.forEach(button => {
                button.addEventListener('click', function() {
                    operationButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    currentOperation = this.dataset.operation;
                    generateProblem();
                });
            });
            difficultyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    difficultyButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    currentDifficulty = this.dataset.difficulty;
                    generateProblem();
                });
            });
            theoryBtn.addEventListener('click', function() {
                document.getElementById('theory-modal').style.display = 'block';
            });
            theoremsBtn.addEventListener('click', function() {
                document.getElementById('theorems-modal').style.display = 'block';
            });
            statsBtn.addEventListener('click', showStats);
            exportStatsBtn.addEventListener('click', exportStats);
            importStatsBtn.addEventListener('click', importStats);
            clearStatsBtn.addEventListener('click', clearStats);
            fileInput.addEventListener('change', function(e) {
                if (!saveData) return;
                
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedStats = JSON.parse(e.target.result);
                        stats = importedStats;
                        if (userConsent) {
                            localStorage.setItem('mathTrainerStats', JSON.stringify(stats));
                        }
                        showStats();
                        alert('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞!');
                    } catch (error) {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç');
                    }
                };
                reader.readAsText(file);
            });
            
            // –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            achievementsBtn.addEventListener('click', showAchievements);
            progressionBtn.addEventListener('click', showProgression);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            generateProblem();
            updateStats();
        }
    </script>
</body>
</html>